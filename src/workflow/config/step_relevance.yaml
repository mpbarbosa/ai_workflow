# Step Relevance Matrix - Project Kind Adaptive Framework
# Defines which workflow steps are relevant for each project kind
# Values: required | recommended | optional | skip

step_relevance:
  shell_script_automation:
    step_00_analyze: required
    step_01_documentation: required
    consistency: required
    script_refs: required        # Shell scripts need validation
    step_04_directory: recommended
    test_review: required
    test_gen: recommended
    test_exec: required
    dependencies: optional       # May not have package.json
    code_quality: required
    context: recommended
    git_finalization: required
    markdown_lint: required
    ux_analysis: skip            # No UI components

  nodejs_api:
    step_00_analyze: required
    step_01_documentation: required
    consistency: required
    script_refs: skip            # No shell scripts typically
    step_04_directory: required
    test_review: required
    test_gen: required
    test_exec: required
    dependencies: required       # Critical for Node.js
    code_quality: required
    context: recommended
    git_finalization: required
    markdown_lint: recommended
    ux_analysis: optional        # May have admin UI

  nodejs_cli:
    step_00_analyze: required
    step_01_documentation: required
    consistency: required
    script_refs: skip
    step_04_directory: recommended
    test_review: required
    test_gen: required
    test_exec: required
    dependencies: required
    code_quality: required
    context: recommended
    git_finalization: required
    markdown_lint: recommended
    ux_analysis: optional        # May have TUI components

  nodejs_library:
    step_00_analyze: required
    step_01_documentation: required      # API docs critical
    consistency: required
    script_refs: skip
    step_04_directory: recommended
    test_review: required        # High test coverage expected
    test_gen: required
    test_exec: required
    dependencies: required
    code_quality: required
    context: recommended
    git_finalization: required
    markdown_lint: required
    ux_analysis: skip            # No UI components

  static_website:
    step_00_analyze: required
    step_01_documentation: recommended   # User-facing content
    consistency: recommended
    script_refs: skip
    step_04_directory: recommended
    test_review: optional        # Limited code
    test_gen: skip
    test_exec: optional
    dependencies: optional
    code_quality: recommended    # HTML/CSS validation
    context: recommended
    git_finalization: required
    markdown_lint: required      # Content quality
    ux_analysis: required        # Static website has UI

  react_spa:
    step_00_analyze: required
    step_01_documentation: recommended   # User docs, not API docs
    consistency: recommended
    script_refs: skip
    step_04_directory: recommended
    test_review: required
    test_gen: required
    test_exec: required
    dependencies: required
    code_quality: required       # Includes accessibility
    context: recommended
    git_finalization: required
    markdown_lint: optional
    ux_analysis: required        # React SPA has UI

  python_app:
    step_00_analyze: required
    step_01_documentation: required
    consistency: required
    script_refs: optional        # May have shell scripts
    step_04_directory: recommended
    test_review: required
    test_gen: required
    test_exec: required
    dependencies: required       # requirements.txt, etc.
    code_quality: required
    context: recommended
    git_finalization: required
    markdown_lint: recommended
    ux_analysis: optional        # May have web UI

  generic:
    step_00_analyze: required
    step_01_documentation: recommended
    consistency: recommended
    script_refs: optional
    step_04_directory: recommended
    test_review: recommended
    test_gen: optional
    test_exec: optional
    dependencies: optional
    code_quality: recommended
    context: recommended
    git_finalization: required
    markdown_lint: recommended
    ux_analysis: optional        # Unknown if UI exists

# Step-specific adaptations for each project kind
step_adaptations:
  test_review:
    nodejs_api:
      focus_areas:
        - "API endpoint coverage"
        - "Error handling tests"
        - "Authentication tests"
        - "Integration tests"
        - "Database interaction tests"
        - "Middleware tests"
      minimum_coverage: 80
      test_types:
        - unit
        - integration
        - e2e

    nodejs_cli:
      focus_areas:
        - "Command execution tests"
        - "Argument parsing tests"
        - "Help/version output tests"
        - "Exit code validation"
        - "Error message tests"
        - "Interactive prompt tests"
      minimum_coverage: 85
      test_types:
        - unit
        - integration

    nodejs_library:
      focus_areas:
        - "Public API coverage"
        - "Edge case handling"
        - "Backward compatibility tests"
        - "Type checking tests"
        - "Error handling"
        - "Performance benchmarks"
      minimum_coverage: 90
      test_types:
        - unit
        - integration
        - performance

    react_spa:
      focus_areas:
        - "Component rendering tests"
        - "User interaction tests"
        - "Accessibility tests"
        - "E2E critical paths"
        - "State management tests"
        - "Routing tests"
      minimum_coverage: 75
      test_types:
        - unit
        - integration
        - e2e

    shell_script_automation:
      focus_areas:
        - "Function unit tests"
        - "Error handling tests"
        - "Integration tests"
        - "End-to-end workflow tests"
        - "Edge case handling"
        - "Exit code validation"
      minimum_coverage: 85
      test_types:
        - unit
        - integration
        - e2e

    python_app:
      focus_areas:
        - "Function coverage"
        - "Class method tests"
        - "Error handling"
        - "Integration tests"
        - "API endpoint tests"
      minimum_coverage: 80
      test_types:
        - unit
        - integration

  test_gen:
    nodejs_api:
      test_frameworks:
        - jest
        - mocha
        - supertest
      test_patterns:
        - "tests/api/*.test.js"
        - "tests/integration/*.test.js"
      generate_types:
        - unit
        - integration

    nodejs_cli:
      test_frameworks:
        - jest
        - mocha
      test_patterns:
        - "tests/commands/*.test.js"
        - "tests/cli/*.test.js"
      generate_types:
        - unit
        - integration

    shell_script_automation:
      test_frameworks:
        - bats
        - custom
      test_patterns:
        - "tests/**/*.sh"
        - "tests/**/test_*.sh"
      generate_types:
        - unit
        - integration

  dependencies:
    nodejs_api:
      check_files:
        - package.json
        - package-lock.json
        - yarn.lock
      security_scan: true
      outdated_check: true
      license_check: true
      focus_areas:
        - "Security vulnerabilities"
        - "Outdated dependencies"
        - "License compatibility"
        - "Dependency size/bloat"

    nodejs_cli:
      check_files:
        - package.json
        - package-lock.json
      security_scan: true
      outdated_check: true
      license_check: true
      focus_areas:
        - "Binary size impact"
        - "CLI-specific dependencies"
        - "Security vulnerabilities"

    nodejs_library:
      check_files:
        - package.json
        - package-lock.json
      security_scan: true
      outdated_check: true
      license_check: true
      peer_dependencies_check: true
      focus_areas:
        - "Minimal dependencies"
        - "Peer dependency conflicts"
        - "Version compatibility"
        - "License compatibility"

    python_app:
      check_files:
        - requirements.txt
        - Pipfile
        - pyproject.toml
      security_scan: true
      outdated_check: true
      focus_areas:
        - "Security vulnerabilities"
        - "Version pinning"
        - "Dependency conflicts"

    shell_script_automation:
      check_files:
        - package.json  # Optional, if Node.js used
      security_scan: false
      outdated_check: false
      focus_areas:
        - "External command availability"
        - "Required system packages"
        - "Version compatibility"

  code_quality:
    nodejs_api:
      linters:
        - eslint
        - prettier
      additional_checks:
        - "Security vulnerability scanning"
        - "SQL injection prevention"
        - "XSS prevention"
        - "Rate limiting implementation"
        - "Input validation"
        - "Authentication security"
        - "API versioning"
        - "Error handling patterns"
      quality_gates:
        eslint_max_warnings: 0
        complexity_threshold: 15

    nodejs_cli:
      linters:
        - eslint
        - prettier
      additional_checks:
        - "Help text clarity"
        - "Error message quality"
        - "Exit code consistency"
        - "Input validation"
        - "Performance for large inputs"
        - "Command naming conventions"
        - "Option consistency"
      quality_gates:
        eslint_max_warnings: 0
        complexity_threshold: 10

    nodejs_library:
      linters:
        - eslint
        - prettier
        - typescript
      additional_checks:
        - "API surface area"
        - "Breaking change detection"
        - "Type definition quality"
        - "Documentation completeness"
        - "Backward compatibility"
      quality_gates:
        eslint_max_warnings: 0
        complexity_threshold: 12
        type_coverage: 90

    react_spa:
      linters:
        - eslint
        - prettier
        - stylelint
      additional_checks:
        - "Accessibility (WCAG 2.1 AA)"
        - "Performance (Lighthouse)"
        - "SEO metadata"
        - "Responsive design"
        - "Browser compatibility"
        - "Bundle size optimization"
        - "Component complexity"
      quality_gates:
        eslint_max_warnings: 0
        lighthouse_performance: 85
        lighthouse_accessibility: 90
        bundle_size_kb: 500

    shell_script_automation:
      linters:
        - shellcheck
        - shfmt
      additional_checks:
        - "POSIX compliance"
        - "Error handling (set -euo pipefail)"
        - "Function documentation"
        - "Variable quoting"
        - "Exit code management"
        - "Trap handlers"
      quality_gates:
        shellcheck_severity: warning
        max_function_lines: 100

    python_app:
      linters:
        - pylint
        - flake8
        - black
        - mypy
      additional_checks:
        - "Type hints coverage"
        - "Docstring completeness"
        - "Import organization"
        - "Code complexity"
      quality_gates:
        pylint_min_score: 8.0
        max_complexity: 10

    static_website:
      linters:
        - htmlhint
        - stylelint
      additional_checks:
        - "HTML validation"
        - "CSS validation"
        - "Link integrity"
        - "Image optimization"
        - "Accessibility"
        - "Mobile responsiveness"
      quality_gates:
        html_errors: 0
        accessibility_score: 85

  context:
    nodejs_api:
      analysis_focus:
        - "API design patterns"
        - "RESTful principles"
        - "Error handling strategy"
        - "Authentication/Authorization"
        - "Data validation approach"
        - "Scalability considerations"

    nodejs_cli:
      analysis_focus:
        - "User experience"
        - "Command structure"
        - "Help documentation"
        - "Error messaging"
        - "Configuration management"
        - "Cross-platform compatibility"

    nodejs_library:
      analysis_focus:
        - "API design"
        - "Public interface"
        - "Versioning strategy"
        - "Backward compatibility"
        - "Documentation quality"
        - "Usage examples"

    react_spa:
      analysis_focus:
        - "Component architecture"
        - "State management"
        - "Routing strategy"
        - "Performance optimization"
        - "User experience"
        - "Accessibility"

    shell_script_automation:
      analysis_focus:
        - "Workflow orchestration"
        - "Error handling strategy"
        - "Modularity and reusability"
        - "Configuration management"
        - "Portability"
        - "Performance"

    static_website:
      analysis_focus:
        - "Content structure"
        - "Navigation hierarchy"
        - "SEO optimization"
        - "Performance"
        - "Mobile experience"
        - "Accessibility"

    python_app:
      analysis_focus:
        - "Code organization"
        - "Design patterns"
        - "Error handling"
        - "Configuration management"
        - "Testing strategy"
        - "Performance"

  ux_analysis:
    react_spa:
      focus_areas:
        - "Component accessibility (ARIA, semantic HTML)"
        - "Responsive design and mobile experience"
        - "User interaction states (hover, focus, disabled)"
        - "Component design patterns and reusability"
        - "Color contrast and visual hierarchy"
        - "Form validation and error messaging"
        - "Loading states and user feedback"
        - "Navigation clarity and consistency"
      analysis_types:
        - accessibility
        - usability
        - visual_design
        - interaction_design
        - performance_perception
      
    static_website:
      focus_areas:
        - "HTML semantic structure"
        - "Content hierarchy and readability"
        - "Mobile responsiveness"
        - "Link accessibility and clarity"
        - "Image optimization and alt text"
        - "Navigation simplicity"
        - "Page load perception"
        - "Cross-browser compatibility"
      analysis_types:
        - accessibility
        - content_structure
        - visual_design
        - performance_perception
    
    documentation_site:
      focus_areas:
        - "Information architecture"
        - "Search functionality"
        - "Code example presentation"
        - "Navigation and discoverability"
        - "Mobile documentation reading"
        - "Dark mode support"
        - "Keyboard navigation"
        - "Content organization"
      analysis_types:
        - information_architecture
        - accessibility
        - content_usability
        - developer_experience
    
    web_application:
      focus_areas:
        - "User flow and task completion"
        - "Accessibility compliance (WCAG 2.1 AA)"
        - "Responsive design patterns"
        - "Interactive element feedback"
        - "Error prevention and recovery"
        - "Visual consistency"
        - "Performance perception"
        - "User onboarding clarity"
      analysis_types:
        - accessibility
        - usability
        - visual_design
        - interaction_design
        - user_flow
